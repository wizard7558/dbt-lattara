# Reference this view as dbt_prod__v_stg_google_campaigns
catalog: DBT
schema: PROD
table_name: V_STG_GOOGLE_CAMPAIGNS

dimensions:
  campaign_id:
    sql: '"CAMPAIGN_ID"'
    format: ID

  customer_id:
    sql: '"CUSTOMER_ID"'
    format: ID

  campaign_name:
    sql: '"CAMPAIGN_NAME"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: v_stg_google_campaigns
  target_schema: PROD
  config:
    materialized: view
  code: |-
    SELECT id as campaign_id
             , customer_id
             , name as campaign_name
        FROM (
            SELECT id
                 , customer_id
                 , name
                 , ROW_NUMBER() OVER (PARTITION BY id ORDER BY updated_at DESC) as rn
            FROM FIVETRAN_DATABASE.GOOGLE_ADS_FM.CAMPAIGN_HISTORY
        )
        WHERE rn = 1
  referenced_by: [ int_google_spend, int_google_conversions ]
