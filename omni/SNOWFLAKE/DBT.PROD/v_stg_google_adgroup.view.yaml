# Reference this view as dbt_prod__v_stg_google_adgroup
catalog: DBT
schema: PROD
table_name: V_STG_GOOGLE_ADGROUP

dimensions:
  ad_group_id:
    sql: '"AD_GROUP_ID"'
    format: ID

  campaign_id:
    sql: '"CAMPAIGN_ID"'
    format: ID

  ad_group_name:
    sql: '"AD_GROUP_NAME"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: v_stg_google_adgroup
  target_schema: PROD
  config:
    materialized: view
  code: |-
    SELECT id as ad_group_id
             , campaign_id
             , name as ad_group_name
        FROM (
            SELECT id
                 , campaign_id
                 , name
                 , ROW_NUMBER() OVER (PARTITION BY id ORDER BY updated_at DESC) as rn
            FROM FIVETRAN_DATABASE.GOOGLE_ADS_FM.AD_GROUP_HISTORY
        )
        WHERE rn = 1
  referenced_by: [ int_google_spend, int_google_conversions ]
