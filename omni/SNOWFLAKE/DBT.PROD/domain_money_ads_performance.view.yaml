# Reference this view as dbt_prod__domain_money_ads_performance
catalog: DBT
schema: PROD
table_name: DOMAIN_MONEY_ADS_PERFORMANCE

dimensions:
  date:
    sql: '"DATE"'
    label: Date
    timeframes: [ raw, date, week, month, quarter, year ]
    convert_tz: false

  platform:
    sql: '"PLATFORM"'
    label: Platform
    description: Meta or Google

  account:
    sql: '"ACCOUNT"'
    label: Account

  campaign:
    sql: '"CAMPAIGN"'
    label: Campaign

  adgroup:
    sql: '"ADGROUP"'
    label: Ad Group / Ad Set

  # Hidden base columns
  spend:
    sql: '"SPEND"'
    hidden: true

  impressions:
    sql: '"IMPRESSIONS"'
    hidden: true

  clicks:
    sql: '"CLICKS"'
    hidden: true

  mql_value:
    sql: '"MQL"'
    hidden: true

measures:
  count:
    aggregate_type: count

  total_spend:
    sql: ${spend}
    label: Total Spend
    format: usdcurrency_2
    aggregate_type: sum

  total_impressions:
    sql: ${impressions}
    label: Total Impressions
    format: number_0
    aggregate_type: sum

  total_clicks:
    sql: ${clicks}
    label: Total Clicks
    format: number_0
    aggregate_type: sum

  mql:
    sql: ${mql_value}
    label: MQL
    format: number_2
    description: Marketing Qualified Leads (schedule_total for Meta, HubSpot MQL for Google)
    aggregate_type: sum

  ctr:
    sql: ${total_clicks} / NULLIF(${total_impressions}, 0) * 100
    label: CTR
    format: percent_2

  cpc:
    sql: ${total_spend} / NULLIF(${total_clicks}, 0)
    label: CPC
    format: usdcurrency_2

  cpm:
    sql: ${total_spend} / NULLIF(${total_impressions}, 0) * 1000
    label: CPM
    format: usdcurrency_2

  cost_per_mql:
    sql: ${total_spend} / NULLIF(${mql}, 0)
    label: Cost per MQL
    format: usdcurrency_2

  conversion_rate:
    sql: ${mql} / NULLIF(${total_clicks}, 0) * 100
    label: Conversion Rate
    format: percent_2
