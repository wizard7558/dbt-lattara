# Reference this view as dbt_prod__v_stg_google_accounts
catalog: DBT
schema: PROD
table_name: V_STG_GOOGLE_ACCOUNTS

dimensions:
  customer_id:
    sql: '"CUSTOMER_ID"'
    format: ID

  account_name:
    sql: '"ACCOUNT_NAME"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: v_stg_google_accounts
  target_schema: PROD
  config:
    materialized: view
  code: |-
    SELECT id as customer_id
             , descriptive_name as account_name
        FROM (
            SELECT id
                 , descriptive_name
                 , ROW_NUMBER() OVER (PARTITION BY id ORDER BY updated_at DESC) as rn
            FROM FIVETRAN_DATABASE.GOOGLE_ADS_FM.ACCOUNT_HISTORY
        )
        WHERE rn = 1
  referenced_by:
    [
      int_google_adgroup_spend,
      int_google_keyword_spend,
      int_google_campaign_spend,
      int_google_adgroup_conversions,
      int_google_keyword_conversions,
      int_google_campaign_conversions
    ]
